# 🌍 AI 여행 추천 시스템

AI 기반의 지능형 여행 계획 추천 시스템입니다. 사용자의 선호도와 관심사를 분석하여 맞춤형 여행 일정을 생성하고, PDF 형태로 다운로드할 수 있습니다.

## ✨ 주요 기능

### 🎯 핵심 기능
- **지능형 여행 계획 생성**: 목적지, 관심사, 기간을 기반으로 맞춤형 일정 생성
- **다국어 지원**: 한국어, 영어, 일본어, 중국어 지원
- **실시간 대화형 인터페이스**: 자연스러운 대화를 통한 여행 정보 수집
- **PDF 일정서 생성**: 완성된 여행 계획을 PDF로 다운로드
- **대화 히스토리 관리**: 이전 대화 내용 저장 및 관리

### 🗺️ 지원 지역
- **한국**: 서울, 부산, 제주도, 경주, 전주, 여수, 강릉, 춘천, 대구, 인천
- **미국**: 뉴욕, 로스앤젤레스, 시카고, 라스베가스, 샌프란시스코, 마이애미, 보스턴, 워싱턴DC, 시애틀, 뉴올리언스
- **일본**: 도쿄, 오사카, 교토, 나고야, 삿포로, 후쿠오카, 고베, 요코하마, 나라, 가나자와
- **중국**: 베이징, 상하이, 광저우, 선전, 청두, 항저우, 시안, 난징, 칭다오, 다롄
- **기타 국가**: 프랑스, 독일, 이탈리아, 스페인, 태국, 베트남, 싱가포르, 호주, 캐나다, 뉴질랜드

### 🎨 관심사 분류
- **음식**: 맛집, 식사, 요리, food, グルメ, 美食
- **자연**: 산, 바다, 공원, nature, 自然, 自然
- **문화**: 박물관, 사찰, 궁전, culture, 文化, 文化
- **쇼핑**: 상점, 시장, shopping, ショッピング, 购物

## 🚀 설치 및 실행

### 1. 환경 설정
```bash
# 프로젝트 클론
git clone <repository-url>
cd TravleApp

# Python 가상환경 생성 및 활성화
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# 의존성 설치
cd backend
pip install -r requirements.txt
```

### 2. 환경 변수 설정
```bash
# .env 파일 생성
cp .env.example .env

# 필요한 환경 변수 설정
OLLAMA_BASE_URL=http://localhost:11434
HUGGINGFACE_API_KEY=your_api_key_here
```

### 3. 서버 실행
```bash
# 백엔드 서버 실행
cd backend
python app.py

# 프론트엔드 접속
# 브라우저에서 http://localhost:5000 접속
```

## 💬 사용 방법

### 기본 사용법
1. **목적지 선택**: "한국여행 추천해줘" 또는 "서울" 입력
2. **도시 선택**: 제시된 도시 목록에서 원하는 도시 선택
3. **관심사 입력**: "음식", "자연", "문화", "쇼핑" 중 선택
4. **기간 설정**: "3일", "1주일", "1달 3일" 등 입력
5. **일정 생성**: AI가 자동으로 맞춤형 여행 일정 생성
6. **PDF 다운로드**: 완성된 일정을 PDF로 다운로드

### 언어 변경
- **한국어**: "한글로 대답해줘"
- **영어**: "영어로 대답해줘"
- **일본어**: "일본어로 대답해줘"
- **중국어**: "중국어로 대답해줘"

### 기간 입력 예시
- **일 단위**: "3일", "5일", "one day", "two days"
- **주 단위**: "1주일", "2주", "1 week", "two weeks"
- **달 단위**: "1달", "2개월", "1 month", "two months"
- **복합 표현**: "1달 3일", "2주 5일", "1 month 3 days"

## 🏗️ 시스템 아키텍처

### 백엔드 구조
```
backend/
├── app.py                 # 메인 Flask 애플리케이션
├── language.py            # 다국어 지원 모듈
├── llm.py                 # LLM 통신 모듈
├── transport.py           # 교통 정보 모듈
├── travel.py              # 여행 정보 처리 모듈
├── utils.py               # 유틸리티 함수
├── requirements.txt       # Python 의존성
└── Noto_Sans_KR/         # 한글 폰트 파일
```

### 프론트엔드 구조
```
travel-bot/frontend/
├── index.html            # 메인 HTML 페이지
├── script.js             # JavaScript 로직
└── style.css             # CSS 스타일링
```

## 🤖 AI 모델 및 프롬프트

### 사용 가능한 AI 모델
- **Ollama**: 로컬 LLM 실행 (권장)
- **Hugging Face**: 클라우드 기반 LLM

### 프롬프트 구조
```python
# 기본 여행 계획 생성 프롬프트
prompt = f"""당신은 여행 전문가입니다. 반드시 한국어로만 답변하세요.

여행 정보:
목적지: {destination_info}
관심사: {interest}
일정: {duration}

{destination_info}의 {interest}에 초점을 맞춘 {duration} 상세한 여행 일정을 만들어주세요. 
각 날짜별 구체적인 장소, 식당, 활동을 포함해주세요."""
```

### 다국어 프롬프트 지원
- **한국어**: 한국어로만 답변하도록 설정
- **영어**: "Please answer ONLY in English"
- **일본어**: "必ず日本語で答えてください"
- **중국어**: "请只用中文回答"

## 📊 데이터 처리 기능

### 텍스트 전처리
- **이모지 제거**: PDF 생성 시 이모지 및 특수문자 자동 제거
- **한글 폰트 지원**: Noto Sans KR 폰트를 사용한 한글 PDF 생성
- **시간 필터링**: 08:00, 12:00, 18:00 일정만 추출
- **중복 제거**: 같은 음식점/가게 이름 중복 시 "다른 현지 음식점"으로 치환

### 일정 최적화
- **Day별 분리**: LLM 응답을 Day 1, Day 2, Day 3로 자동 분리
- **일정 수 조정**: 요청된 일수에 맞게 일정 자동 조정
- **실제 장소명 검증**: 실제 존재하는 장소명으로 교체

## 🔧 기술 스택

### 백엔드
- **Flask**: Python 웹 프레임워크
- **Ollama**: 로컬 LLM 실행
- **Hugging Face**: 클라우드 LLM API
- **ReportLab**: PDF 생성
- **Python-dotenv**: 환경 변수 관리

### 프론트엔드
- **HTML5**: 웹 페이지 구조
- **CSS3**: 스타일링
- **JavaScript**: 동적 인터페이스
- **Fetch API**: 서버 통신

### 데이터베이스
- **Flask Session**: 세션 기반 상태 관리
- **JSON**: 대화 히스토리 저장

## 🎯 핵심 알고리즘

### 1. Slot-Filling 시스템
```python
# 사용자 상태 관리
user_state = {
    'destination': '서울',      # 목적지
    'destination_city': '서울', # 도시
    'interest': '음식',         # 관심사
    'duration': '3일'          # 기간
}
```

### 2. 지능형 입력 인식
- **도시 추출**: 정규표현식을 통한 도시명 자동 인식
- **국가 인식**: "한국여행" 패턴에서 국가명 자동 추출
- **관심사 분류**: 키워드 매칭을 통한 관심사 자동 분류
- **기간 파싱**: 다양한 시간 표현을 일수로 변환

### 3. 대화 상태 관리
- **단계별 진행**: 목적지 → 도시 → 관심사 → 기간 순서로 진행
- **오류 처리**: 잘못된 입력에 대한 적절한 안내 메시지
- **언어별 응답**: 선택된 언어에 맞는 응답 제공

## 📝 API 엔드포인트

### 주요 API
- `POST /chat`: 메인 대화 인터페이스
- `GET /download-pdf`: PDF 일정서 다운로드
- `GET /history`: 대화 히스토리 조회
- `POST /reset_user_state`: 사용자 상태 초기화

### 응답 형식
```json
{
    "response": "AI 응답 메시지",
    "status": "success"
}
```

## 🎨 사용자 인터페이스

### 대화형 인터페이스
- **실시간 채팅**: 웹 기반 채팅 인터페이스
- **자동 스크롤**: 새 메시지 자동 스크롤
- **로딩 표시**: AI 응답 대기 중 로딩 애니메이션
- **PDF 다운로드**: 완성된 일정 PDF 다운로드 버튼

### 반응형 디자인
- **모바일 지원**: 모바일 기기에서도 최적화된 화면
- **크로스 브라우저**: 주요 브라우저 모두 지원

## 🔍 문제 해결

### 자주 발생하는 문제
1. **Ollama 연결 오류**: Ollama 서버가 실행 중인지 확인
2. **한글 폰트 오류**: Noto Sans KR 폰트 파일 존재 확인
3. **PDF 생성 실패**: ReportLab 라이브러리 설치 확인

### 디버깅
- **로그 확인**: 콘솔에서 DEBUG 메시지 확인
- **세션 초기화**: `/reset_user_state` API 호출로 상태 초기화
- **브라우저 개발자 도구**: 네트워크 탭에서 API 응답 확인

## 🚀 향후 개발 계획

### 단기 계획
- [ ] 더 많은 국가 및 도시 추가
- [ ] 실시간 교통 정보 연동
- [ ] 호텔 예약 시스템 연동
- [ ] 날씨 정보 통합

### 장기 계획
- [ ] 머신러닝 기반 개인화 추천
- [ ] AR/VR 여행 미리보기
- [ ] 소셜 기능 (여행 계획 공유)
- [ ] 모바일 앱 개발

## 📄 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다.

## 🤝 기여하기

1. Fork the Project
2. Create your Feature Branch (`git checkout -b feature/AmazingFeature`)
3. Commit your Changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the Branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## 📞 문의

프로젝트에 대한 문의사항이나 버그 리포트는 이슈를 통해 제출해주세요.

---

**AI 여행 추천 시스템**으로 더 스마트한 여행 계획을 시작하세요! 🌟 